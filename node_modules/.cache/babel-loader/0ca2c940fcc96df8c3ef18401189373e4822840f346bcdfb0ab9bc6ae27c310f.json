{"ast":null,"code":"import \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { defineStore } from 'pinia';\nimport axios from 'axios';\nimport router from '../router/index';\nimport { Preferences } from '@capacitor/preferences';\naxios.defaults.baseURL = \"https://gae.co.bw/\";\naxios.defaults.baseURL = \"http://127.0.0.1:8000/\";\n// const test = await authStore.getToken()\nexport const useAuthStore = defineStore('auth', {\n  state: () => {\n    return {\n      authenticated: false,\n      // base_url: \"https://gae.co.bw/\",\n      base_url: \"http://127.0.0.1:8000/\",\n      error: null,\n      token: null,\n      user: null,\n      dob: \"\",\n      gender: \"\"\n    };\n  },\n  getters: {\n    loggedIn: state => state.user ? true : false,\n    useToken: () => Preferences.get({\n      key: 'token'\n    })\n  },\n  actions: {\n    getToken() {\n      this.token = Preferences.get({\n        key: 'token'\n      });\n    },\n    async setToken(token) {\n      await Preferences.set({\n        key: 'token',\n        value: token\n      });\n    },\n    async setUser(user) {\n      await Preferences.set({\n        key: 'user',\n        value: JSON.stringify(user)\n      });\n    },\n    async login(email, password) {\n      const config = {\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': '*'\n        }\n      };\n      await axios.post('/api/v1/auth/login', {\n        email: email,\n        device_name: 'Mobile',\n        password: password\n      }, config).then(res => {\n        console.log('#######################################################');\n        console.log(\"Authentication Successful\");\n        console.log('#######################################################');\n        this.authenticated = true;\n        console.log(res.data);\n        this.user = res.data.user;\n        this.token = res.data.token;\n        this.setToken(res.data.token);\n        this.setUser(JSON.stringify(res.data.user));\n      }).catch(error => {\n        this.error = error.response.data.message;\n      });\n    },\n    async logout() {\n      const config = {\n        'Accept': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n        'Content-Type': 'application/json'\n      };\n      await axios.post('/logout', {}, config).then(() => {\n        this.user = null;\n        localStorage.removeItem(\"event\");\n        localStorage.removeItem(\"events\");\n        localStorage.removeItem(\"timer\");\n      }).catch(() => {\n        this.user = null;\n        localStorage.removeItem(\"event\");\n        localStorage.removeItem(\"events\");\n        localStorage.removeItem(\"timer\");\n      });\n      router.push('/login');\n    }\n  }\n});","map":{"version":3,"names":["defineStore","axios","router","Preferences","defaults","baseURL","useAuthStore","state","authenticated","base_url","error","token","user","dob","gender","getters","loggedIn","useToken","get","key","actions","getToken","setToken","set","value","setUser","JSON","stringify","login","email","password","config","headers","post","device_name","then","res","console","log","data","catch","response","message","logout","localStorage","removeItem","push"],"sources":["C:/Users/USER/Desktop/home/src/stores/auth.js"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport axios from 'axios';\r\nimport router from '../router/index'\r\nimport { Preferences } from '@capacitor/preferences';\r\n\r\naxios.defaults.baseURL = \"https://gae.co.bw/\"\r\naxios.defaults.baseURL = \"http://127.0.0.1:8000/\"\r\n// const test = await authStore.getToken()\r\nexport const useAuthStore = defineStore('auth', {\r\n    state: () => {\r\n        return {\r\n            authenticated: false,\r\n            // base_url: \"https://gae.co.bw/\",\r\n            base_url: \"http://127.0.0.1:8000/\",\r\n            error: null,\r\n            token: null,\r\n            user: null,\r\n            dob: \"\",\r\n            gender: \"\",\r\n        }\r\n    },\r\n    getters: {\r\n        loggedIn: (state) => (state.user ? true : false),\r\n        useToken:  () => Preferences.get({ key: 'token' }),\r\n    },\r\n    actions: {\r\n\r\n        getToken() {\r\n          this.token = Preferences.get({ key: 'token' });\r\n        },\r\n\r\n        async setToken (token) {\r\n          await Preferences.set({\r\n            key: 'token',\r\n            value: token,\r\n          });\r\n        },\r\n\r\n        async setUser (user) {\r\n          await Preferences.set({\r\n            key: 'user',\r\n            value: JSON.stringify(user),\r\n          });\r\n        },\r\n\r\n        async login(email, password) {\r\n\r\n          const config = {\r\n            headers:{\r\n              'Accept': 'application/json',\r\n              'Content-Type': 'application/json',\r\n              'Access-Control-Allow-Origin': '*',\r\n            }\r\n          };\r\n\r\n          await axios.post('/api/v1/auth/login', {\r\n            email: email,\r\n            device_name: 'Mobile',\r\n            password: password\r\n          }, config).then((res) => {\r\n            \r\n            console.log('#######################################################')\r\n            console.log(\"Authentication Successful\");\r\n            console.log('#######################################################')\r\n            this.authenticated = true;\r\n\r\n            console.log(res.data)\r\n            this.user = res.data.user;\r\n            this.token = res.data.token;\r\n            this.setToken(res.data.token);\r\n            this.setUser(JSON.stringify(res.data.user));\r\n            \r\n          }).catch((error) => {\r\n            this.error = error.response.data.message;\r\n          });\r\n\r\n          \r\n        },\r\n\r\n        async logout() {\r\n\r\n            const config = {\r\n              'Accept': 'application/json',\r\n              'Access-Control-Allow-Origin': '*',\r\n              'Content-Type': 'application/json',\r\n            };\r\n\r\n            await axios.post('/logout', {\r\n              },config).then(() => {\r\n                \r\n                this.user = null;\r\n                localStorage.removeItem(\"event\");\r\n                localStorage.removeItem(\"events\");\r\n                localStorage.removeItem(\"timer\");\r\n\r\n              }).catch(() => {\r\n          \r\n                this.user = null;\r\n                localStorage.removeItem(\"event\");\r\n                localStorage.removeItem(\"events\");\r\n                localStorage.removeItem(\"timer\");\r\n\r\n              });\r\n\r\n              router.push('/login')\r\n              \r\n        }\r\n    }\r\n})"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { defineStore } from 'pinia';\nimport axios from 'axios';\nimport router from '../router/index';\nimport { Preferences } from '@capacitor/preferences';\naxios.defaults.baseURL = \"https://gae.co.bw/\";\n// const test = await authStore.getToken()\nexport const useAuthStore = defineStore('auth', {\n  state: () => {\n    return {\n      authenticated: false,\n      base_url: \"https://gae.co.bw/\",\n      error: null,\n      token: localStorage.getItem('token') || null,\n      user: null,\n      dob: \"\",\n      gender: \"\"\n    };\n  },\n  getters: {\n    loggedIn: state => state.user ? true : false\n    // getToken: async () => await Preferences.get({ key: 'token' }),\n  },\n\n  actions: {\n    async getToken() {\n      return await Preferences.get({\n        key: 'token'\n      });\n    },\n    async setToken(token) {\n      await Preferences.set({\n        key: 'token',\n        value: token\n      });\n    },\n    async setUser(user) {\n      await Preferences.set({\n        key: 'user',\n        value: JSON.stringify(user)\n      });\n    },\n    async login(email, password) {\n      const config = {\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      };\n      await axios.post('/api/profile/login', {\n        email: email,\n        password: password\n      }, config).then(res => {\n        console.log('#######################################################');\n        console.log(\"Authentication Successful\");\n        console.log('#######################################################');\n        this.authenticated = true;\n        this.user = res.data.user;\n        this.setToken(res.data.token);\n      }).catch(error => {\n        this.error = error.response.data.message;\n      });\n    },\n    async logout() {\n      const config = {\n        'Accept': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n        'Content-Type': 'application/json'\n      };\n      await axios.post('/logout', {}, config).then(() => {\n        this.user = null;\n        localStorage.removeItem(\"event\");\n        localStorage.removeItem(\"events\");\n        localStorage.removeItem(\"timer\");\n      }).catch(() => {\n        this.user = null;\n        localStorage.removeItem(\"event\");\n        localStorage.removeItem(\"events\");\n        localStorage.removeItem(\"timer\");\n      });\n      router.push('/login');\n    }\n  }\n});","map":{"version":3,"names":["defineStore","axios","router","Preferences","defaults","baseURL","useAuthStore","state","authenticated","base_url","error","token","localStorage","getItem","user","dob","gender","getters","loggedIn","actions","getToken","get","key","setToken","set","value","setUser","JSON","stringify","login","email","password","config","headers","post","then","res","console","log","data","catch","response","message","logout","removeItem","push"],"sources":["C:/Users/USER/Desktop/home/src/stores/auth.js"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport axios from 'axios';\r\nimport router from '../router/index'\r\nimport { Preferences } from '@capacitor/preferences';\r\n\r\naxios.defaults.baseURL = \"https://gae.co.bw/\"\r\n// const test = await authStore.getToken()\r\nexport const useAuthStore = defineStore('auth', {\r\n    state: () => {\r\n        return {\r\n            authenticated: false,\r\n            base_url: \"https://gae.co.bw/\",\r\n            error: null,\r\n            token: localStorage.getItem('token') || null,\r\n            user: null,\r\n            dob: \"\",\r\n            gender: \"\",\r\n        }\r\n    },\r\n    getters: {\r\n        loggedIn: (state) => (state.user ? true : false),\r\n        // getToken: async () => await Preferences.get({ key: 'token' }),\r\n    },\r\n    actions: {\r\n\r\n        async getToken() {\r\n          return await Preferences.get({ key: 'token' });\r\n        },\r\n\r\n        async setToken (token) {\r\n          await Preferences.set({\r\n            key: 'token',\r\n            value: token,\r\n          });\r\n        },\r\n\r\n        async setUser (user) {\r\n          await Preferences.set({\r\n            key: 'user',\r\n            value: JSON.stringify(user),\r\n          });\r\n        },\r\n\r\n        async login(email, password) {\r\n\r\n          const config = {\r\n            headers:{\r\n              'Accept': 'application/json',\r\n              'Content-Type': 'application/json',\r\n            }\r\n          };\r\n\r\n          await axios.post('/api/profile/login', {\r\n            email: email,\r\n            password: password\r\n          }, config).then((res) => {\r\n            \r\n            console.log('#######################################################')\r\n            console.log(\"Authentication Successful\");\r\n            console.log('#######################################################')\r\n            this.authenticated = true;\r\n\r\n            this.user = res.data.user;\r\n\r\n            this.setToken(res.data.token);\r\n            \r\n\r\n          }).catch((error) => {\r\n            this.error = error.response.data.message;\r\n          });\r\n\r\n          \r\n        },\r\n        async logout() {\r\n\r\n            const config = {\r\n              'Accept': 'application/json',\r\n              'Access-Control-Allow-Origin': '*',\r\n              'Content-Type': 'application/json',\r\n            };\r\n\r\n            await axios.post('/logout', {\r\n              },config).then(() => {\r\n                \r\n                this.user = null;\r\n                localStorage.removeItem(\"event\");\r\n                localStorage.removeItem(\"events\");\r\n                localStorage.removeItem(\"timer\");\r\n\r\n              }).catch(() => {\r\n          \r\n                this.user = null;\r\n                localStorage.removeItem(\"event\");\r\n                localStorage.removeItem(\"events\");\r\n                localStorage.removeItem(\"timer\");\r\n\r\n              });\r\n\r\n              router.push('/login')\r\n              \r\n        }\r\n    }\r\n})"],"mappings":";;AAAA,SAASA,WAAW,QAAQ,OAAO;AACnC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,iBAAiB;AACpC,SAASC,WAAW,QAAQ,wBAAwB;AAEpDF,KAAK,CAACG,QAAQ,CAACC,OAAO,GAAG,oBAAoB;AAC7C;AACA,OAAO,MAAMC,YAAY,GAAGN,WAAW,CAAC,MAAM,EAAE;EAC5CO,KAAK,EAAE,MAAM;IACT,OAAO;MACHC,aAAa,EAAE,KAAK;MACpBC,QAAQ,EAAE,oBAAoB;MAC9BC,KAAK,EAAE,IAAI;MACXC,KAAK,EAAEC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,IAAI,IAAI;MAC5CC,IAAI,EAAE,IAAI;MACVC,GAAG,EAAE,EAAE;MACPC,MAAM,EAAE;IACZ,CAAC;EACL,CAAC;EACDC,OAAO,EAAE;IACLC,QAAQ,EAAGX,KAAK,IAAMA,KAAK,CAACO,IAAI,GAAG,IAAI,GAAG;IAC1C;EACJ,CAAC;;EACDK,OAAO,EAAE;IAEL,MAAMC,QAAQ,GAAG;MACf,OAAO,MAAMjB,WAAW,CAACkB,GAAG,CAAC;QAAEC,GAAG,EAAE;MAAQ,CAAC,CAAC;IAChD,CAAC;IAED,MAAMC,QAAQ,CAAEZ,KAAK,EAAE;MACrB,MAAMR,WAAW,CAACqB,GAAG,CAAC;QACpBF,GAAG,EAAE,OAAO;QACZG,KAAK,EAAEd;MACT,CAAC,CAAC;IACJ,CAAC;IAED,MAAMe,OAAO,CAAEZ,IAAI,EAAE;MACnB,MAAMX,WAAW,CAACqB,GAAG,CAAC;QACpBF,GAAG,EAAE,MAAM;QACXG,KAAK,EAAEE,IAAI,CAACC,SAAS,CAACd,IAAI;MAC5B,CAAC,CAAC;IACJ,CAAC;IAED,MAAMe,KAAK,CAACC,KAAK,EAAEC,QAAQ,EAAE;MAE3B,MAAMC,MAAM,GAAG;QACbC,OAAO,EAAC;UACN,QAAQ,EAAE,kBAAkB;UAC5B,cAAc,EAAE;QAClB;MACF,CAAC;MAED,MAAMhC,KAAK,CAACiC,IAAI,CAAC,oBAAoB,EAAE;QACrCJ,KAAK,EAAEA,KAAK;QACZC,QAAQ,EAAEA;MACZ,CAAC,EAAEC,MAAM,CAAC,CAACG,IAAI,CAAEC,GAAG,IAAK;QAEvBC,OAAO,CAACC,GAAG,CAAC,yDAAyD,CAAC;QACtED,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC;QACxCD,OAAO,CAACC,GAAG,CAAC,yDAAyD,CAAC;QACtE,IAAI,CAAC9B,aAAa,GAAG,IAAI;QAEzB,IAAI,CAACM,IAAI,GAAGsB,GAAG,CAACG,IAAI,CAACzB,IAAI;QAEzB,IAAI,CAACS,QAAQ,CAACa,GAAG,CAACG,IAAI,CAAC5B,KAAK,CAAC;MAG/B,CAAC,CAAC,CAAC6B,KAAK,CAAE9B,KAAK,IAAK;QAClB,IAAI,CAACA,KAAK,GAAGA,KAAK,CAAC+B,QAAQ,CAACF,IAAI,CAACG,OAAO;MAC1C,CAAC,CAAC;IAGJ,CAAC;IACD,MAAMC,MAAM,GAAG;MAEX,MAAMX,MAAM,GAAG;QACb,QAAQ,EAAE,kBAAkB;QAC5B,6BAA6B,EAAE,GAAG;QAClC,cAAc,EAAE;MAClB,CAAC;MAED,MAAM/B,KAAK,CAACiC,IAAI,CAAC,SAAS,EAAE,CAC1B,CAAC,EAACF,MAAM,CAAC,CAACG,IAAI,CAAC,MAAM;QAEnB,IAAI,CAACrB,IAAI,GAAG,IAAI;QAChBF,YAAY,CAACgC,UAAU,CAAC,OAAO,CAAC;QAChChC,YAAY,CAACgC,UAAU,CAAC,QAAQ,CAAC;QACjChC,YAAY,CAACgC,UAAU,CAAC,OAAO,CAAC;MAElC,CAAC,CAAC,CAACJ,KAAK,CAAC,MAAM;QAEb,IAAI,CAAC1B,IAAI,GAAG,IAAI;QAChBF,YAAY,CAACgC,UAAU,CAAC,OAAO,CAAC;QAChChC,YAAY,CAACgC,UAAU,CAAC,QAAQ,CAAC;QACjChC,YAAY,CAACgC,UAAU,CAAC,OAAO,CAAC;MAElC,CAAC,CAAC;MAEF1C,MAAM,CAAC2C,IAAI,CAAC,QAAQ,CAAC;IAE3B;EACJ;AACJ,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
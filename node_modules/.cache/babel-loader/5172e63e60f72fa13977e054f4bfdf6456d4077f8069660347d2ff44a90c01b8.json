{"ast":null,"code":"import { defineStore } from 'pinia';\nimport { Geolocation, GeolocationPosition, PermissionStatus } from '@capacitor/geolocation';\nexport const useLocationStore = defineStore('location', {\n  state: () => {\n    return {\n      permission: \"\",\n      location: null\n    };\n  },\n  getters: {\n    isPermitted: state => state.location ? true : false\n  },\n  actions: {\n    async initLocation() {\n      // await checkLocationPermission();\n\n      //For test ENV\n      await this.getLocation();\n      const x = this.location;\n      const array = {\n        \"coords\": {\n          \"latitude\": x.coords.latitude,\n          \"longitude\": x.coords.longitude\n        }\n      };\n      this.location = array;\n    },\n    getLocation() {\n      return new Promise((resolve, reject) => {\n        if (navigator.geolocation) {\n          navigator.geolocation.getCurrentPosition(this.successCallback, this.errorCallback);\n        } else {\n          this.permission = \"denied\";\n          console.log(\"Geolocation is not supported by this browser.\");\n        }\n      });\n    },\n    // Check for location permission on mount\n    async checkLocationPermission() {\n      const status = await Geolocation.checkPermissions();\n      this.permission = status;\n      if (status.location === 'denied') {\n        console.log('Location permission denied.');\n      } else if (status.location === 'granted') {\n        console.log('Location permission granted.');\n        this.getCurrentLocation();\n      } else {\n        console.log('Location permission not requested. Requesting permission now.');\n        this.requestLocationPermission();\n      }\n      this.getCurrentLocation();\n    },\n    // Request location permission\n    async requestLocationPermission() {\n      const status = await Geolocation.requestPermissions();\n      this.permission = status;\n      if (status.location === 'granted') {\n        console.log('Location permission granted.');\n        this.getCurrentLocation();\n      } else {\n        console.log('Location permission denied.');\n      }\n    },\n    // Get current location\n    async getCurrentLocation() {\n      const pos = await Geolocation.getCurrentPosition();\n      this.location = pos;\n    },\n    async successCallback(position) {\n      const latitude = position.coords.latitude;\n      const longitude = position.coords.longitude;\n      this.location = position;\n      console.log(\"Latitude: \" + latitude + \" Longitude: \" + longitude);\n    },\n    async errorCallback(error) {\n      this.permission = \"denied\";\n      console.log(\"Unable to retrieve your location due to \" + error.code + \": \" + error.message);\n    }\n  }\n});","map":{"version":3,"names":["defineStore","Geolocation","GeolocationPosition","PermissionStatus","useLocationStore","state","permission","location","getters","isPermitted","actions","initLocation","getLocation","x","array","coords","latitude","longitude","Promise","resolve","reject","navigator","geolocation","getCurrentPosition","successCallback","errorCallback","console","log","checkLocationPermission","status","checkPermissions","getCurrentLocation","requestLocationPermission","requestPermissions","pos","position","error","code","message"],"sources":["C:/Users/USER/Desktop/home/src/stores/location.js"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport {  Geolocation, GeolocationPosition, PermissionStatus  } from '@capacitor/geolocation';\r\n\r\nexport const useLocationStore = defineStore('location', {\r\n    state: () => {\r\n        return {\r\n            permission: \"\",\r\n            location: null,\r\n        }\r\n    },\r\n    getters: {\r\n        isPermitted: (state) => (state.location ? true : false),\r\n    },\r\n    actions: {\r\n        async initLocation() {\r\n            // await checkLocationPermission();\r\n\r\n            //For test ENV\r\n            await this.getLocation();\r\n\r\n            const x = this.location;\r\n            const array = {\"coords\": {\"latitude\": x.coords.latitude, \"longitude\": x.coords.longitude}}\r\n            this.location = array;\r\n\r\n        },\r\n\r\n        getLocation(){\r\n            return new Promise((resolve, reject) => {\r\n\r\n                if (navigator.geolocation) {\r\n                    navigator.geolocation.getCurrentPosition(this.successCallback, this.errorCallback);\r\n                } else {\r\n                    this.permission = \"denied\"\r\n                    console.log(\"Geolocation is not supported by this browser.\");\r\n                }\r\n                \r\n            });\r\n        },\r\n        // Check for location permission on mount\r\n        async checkLocationPermission () {\r\n            const status = await Geolocation.checkPermissions();\r\n\r\n            this.permission = status;\r\n\r\n            if (status.location === 'denied') {\r\n                console.log('Location permission denied.');\r\n            } else if (status.location === 'granted') {\r\n                console.log('Location permission granted.');\r\n                this.getCurrentLocation();\r\n            } else {\r\n                console.log('Location permission not requested. Requesting permission now.');\r\n                this.requestLocationPermission();\r\n            }\r\n\r\n            this.getCurrentLocation();\r\n        },\r\n\r\n        // Request location permission\r\n        async requestLocationPermission () {\r\n            const status = await Geolocation.requestPermissions();\r\n\r\n            this.permission = status;\r\n\r\n            if (status.location === 'granted') {\r\n                console.log('Location permission granted.');\r\n                this.getCurrentLocation();\r\n            } else {\r\n                console.log('Location permission denied.');\r\n            }\r\n        },\r\n\r\n        // Get current location\r\n        async getCurrentLocation () {\r\n            const pos = await Geolocation.getCurrentPosition();\r\n            this.location = pos;\r\n        },\r\n\r\n        async successCallback (position) {\r\n            const latitude = position.coords.latitude;\r\n            const longitude = position.coords.longitude;\r\n\r\n            \r\n            this.location = position;\r\n            console.log(\"Latitude: \" + latitude + \" Longitude: \" + longitude);\r\n        },\r\n\r\n        async errorCallback(error) {\r\n            this.permission = \"denied\"\r\n            console.log(\"Unable to retrieve your location due to \" + error.code + \": \" + error.message);\r\n        }\r\n    }\r\n})"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}